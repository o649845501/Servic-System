<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../../static/layui/css/layui.css">

</head>
<body>

<blockquote class="layui-elem-quote">数据监控中心</blockquote>
<a href="{:url('/adduserxml')}" class="layui-btn" id="addadmin">添加账号</a>
<table id="demo" lay-filter="demo"></table>
<script type="text/html" id="barDemo">
    <i class="layui-icon layui-icon-delete"></i>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script src="../../static/layui/layui.js"></script>
<script src="../../static/jquery-3.4.1.js"></script>
<script>
    layui.use('table', function(){
        var table = layui.table;

        //第一个实例
        table.render({
            elem: '#demo'
            ,height: 312
            ,url: '/index.php/Apexuser' //数据接口
            ,page: true //开启分页
            ,parseData: function(res){ //res 即为原始返回的数据
                return {
                    "code": 0, //解析接口状态
                    "msg": '', //解析提示文本
                    "count": res.count, //解析数据长度
                    "data": res.data,//解析数据列表
                };
            }
            ,cols: [[ //表头
                {field: 'Id', title: 'ID', width:80, sort: true, fixed: 'left'}
                ,{field: 'user', title: '用户名',event:'setuser', width:80}
                ,{field: 'password', title: '密码',event:'setname', width:100,}
                ,{field: 'create_time', title: '到期时间', width: 200, sort: true}
                ,{fixed: 'right', title:'操作', toolbar: '#barDemo', width:150}

            ]]
        });
        // table.on('tool(demo)', function(obj){
        //     var data = obj.data;
        //     //监听列表删除按钮
        //     if(obj.event === 'del'){
        //         var str= data;
        //
        //        layer.confirm('真的删除行么', function(index){
        //            $.ajax({
        //                url:'/index.php/delate/deladmin'
        //                ,type:'POST'
        //                ,data:{str}
        //                ,success:function(rst){
        //                    if (rst)
        //                    {
        //                        obj.del();
        //                        layer.close(index);
        //                        alert('删除成功')
        //                    }
        //                    else
        //                    {
        //                        alert('删除失败')
        //                    }
        //                }
        //
        //            });
        //
        //         });
        //     }
        //     else if(obj.event === 'setuser'){
        //         var str= data;//数组转string
        //         layer.prompt({
        //             formType: 2
        //             ,title: '修改 ID 为 ['+ data.Id +'] 账号'
        //             ,value: data.user
        //         }, function(value, index){
        //             layer.close(index);
        //             data.user = value;
        //             $.ajax({
        //                 url:'/index.php/Update/upadmin'
        //                 ,type:'POST'
        //                 ,data:{data}
        //                 ,success:function(rst){
        //                     if (rst)
        //                     {
        //                         alert(rst)
        //                         obj.update({
        //                             user: value
        //                         });
        //                     }
        //                     else
        //                     {
        //                         alert('删除失败')
        //                     }
        //                 }
        //
        //             });
        //
        //         });
        //     }
        //     else if(obj.event === 'setname'){
        //         layer.prompt({
        //             formType: 2
        //             ,title: '修改 ID 为 ['+ data.Id +'] 姓名'
        //             ,value: data.name
        //         }, function(value, index){
        //             layer.close(index);
        //             data.name = value;
        //             //这里一般是发送修改的Ajax请求
        //             $.ajax({
        //                 url:'/index.php/Update/upadmin'
        //                 ,type:'POST'
        //                 ,data:{data}
        //                 ,success:function(rst){
        //                     if (rst)
        //                     {
        //                         alert(rst)
        //                         obj.update({
        //                             user: value
        //                         });
        //                     }
        //                     else
        //                     {
        //                         alert('修改失败')
        //                     }
        //                 }
        //
        //             });
        //             //同步更新表格和缓存对应的值
        //             obj.update({
        //                 name: value
        //             });
        //         });
        //     }
        //     else if(obj.event === 'setstatus'){
        //         layer.confirm('确认修改状态?', {icon: 3, title:'提示'}, function(index){
        //             $.ajax({
        //                 url:'/index.php/Update/upadminstatus'
        //                 ,type:'POST'
        //                 ,data:{data}
        //                 ,success:function(rst){
        //                         alert('修改成功');
        //                         obj.update({
        //                             status:rst
        //                         });
        //                 }
        //
        //             });
        //             layer.close(index);
        //         });
        //     }
        //     else if(obj.event === 'setgender'){
        //         layer.prompt({
        //             formType: 2
        //             ,title: '修改 ID 为 ['+ data.Id +'] 的性别为'
        //             ,value: data.gender
        //         }, function(value, index){
        //             layer.close(index);
        //             data.gender = value;
        //             //这里一般是发送修改的Ajax请求
        //             $.ajax({
        //                 url:'/index.php/Update/upadmin'
        //                 ,type:'POST'
        //                 ,data:{data}
        //                 ,success:function(rst){
        //                     if (rst)
        //                     {
        //                         alert(rst)
        //                         //同步更新表格和缓存对应的值
        //                         obj.update({
        //                             gender: value
        //                         });
        //                     }
        //                     else
        //                     {
        //                         alert('修改失败')
        //                     }
        //                 }
        //
        //             });
        //
        //         });
        //     }
        //
        // });

    });

</script>

</body>
</html>